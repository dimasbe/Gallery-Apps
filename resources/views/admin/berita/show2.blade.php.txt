@extends('layouts.admin')

@section('content')
<div class="bg-white shadow-md rounded-lg p-6 mb-6">
    <div class="flex justify-between items-center">
        <h1 class="text-3xl font-bold text-red-800">Detail Berita</h1>
        <nav aria-label="breadcrumb">
            <ol class="flex items-center text-sm text-gray-600">
                <li class="flex items-center">
                    <a href="{{ route('admin.dashboard') }}" class="hover:text-custom-primary-red">Beranda</a>
                    <span class="mx-2 text-custom-primary-red text-base">&bull;</span>
                </li>
                <li class="flex items-center">
                    <a href="{{ route('admin.berita.index') }}" class="hover:text-custom-primary-red">Berita</a>
                    <span class="mx-2 text-custom-primary-red text-base">&bull;</span>
                </li>
                <li class="text-custom-primary-red" aria-current="page">{{ $berita->judul_berita }}</li>
            </ol>
        </nav>
    </div>
</div>

<div class="container mx-auto p-6 bg-white rounded-lg shadow-md">
    <div class="max-w-4xl mx-auto">
        <h1 class="text-3xl font-bold mb-4 text-red-800 text-center">{{ $berita->judul_berita }}</h1>
        <div class="text-gray-600 text-sm mb-6 text-center">
            Oleh <span class="font-semibold">{{ $berita->penulis }}</span> pada {{ \Carbon\Carbon::parse($berita->tanggal_dibuat)->format('d F Y') }}
            @if($berita->kategoris->isNotEmpty())
                <span class="mx-1">&bull;</span> Kategori:
                @foreach($berita->kategoris as $kategori)
                    <span class="inline-block bg-red-100 text-red-800 text-xs font-medium px-2.5 py-0.5 rounded-full">{{ $kategori->nama_kategori }}</span>@if(!$loop->last),@endif
                @endforeach
            @endif
        </div>

        @php
            $thumbnail = $berita->fotoBeritas->where('tipe', 'thumbnail')->first();
            $additionalImages = $berita->fotoBeritas->where('tipe', 'tambahan');

            // Pisahkan isi berita ke dalam paragraf
            $paragraphs = explode("\n\n", $berita->isi_berita); // Asumsi paragraf dipisahkan oleh dua baris baru
            $imageIndex = 0; // Untuk melacak gambar tambahan
        @endphp

        {{-- Tampilkan Thumbnail Berita --}}
        @if($thumbnail)
            <figure class="mb-8">
                <img src="{{ Storage::url($thumbnail->nama_gambar) }}" alt="{{ $thumbnail->keterangan_gambar ?? 'Thumbnail Berita' }}" class="w-full h-auto object-cover rounded-lg shadow-md">
                @if($thumbnail->keterangan_gambar)
                    <figcaption class="text-center text-sm text-gray-500 mt-2">{{ $thumbnail->keterangan_gambar }}</figcaption>
                @endif
            </figure>
        @endif

        <div class="prose max-w-none text-gray-800 leading-relaxed text-justify">
            @foreach($paragraphs as $index => $paragraph)
                <p class="mb-4">{{ $paragraph }}</p>

                {{-- Sisipkan gambar tambahan setelah setiap paragraf atau sesuai kebutuhan --}}
                @if(isset($additionalImages[$imageIndex]))
                    <figure class="mb-8">
                        <img src="{{ Storage::url($additionalImages[$imageIndex]->nama_gambar) }}" alt="{{ $additionalImages[$imageIndex]->keterangan_gambar ?? 'Gambar Berita' }}" class="w-full h-auto object-cover rounded-lg shadow-md">
                        @if($additionalImages[$imageIndex]->keterangan_gambar)
                            <figcaption class="text-center text-sm text-gray-500 mt-2">{{ $additionalImages[$imageIndex]->keterangan_gambar }}</figcaption>
                        @endif
                    </figure>
                    @php $imageIndex++; @endphp
                @endif
            @endforeach
        </div>

        <div class="pt-6 flex justify-end space-x-4 border-t border-gray-200 mt-8">
            <a href="{{ route('admin.berita.index') }}" class="inline-flex justify-center py-2 px-4 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2">
                Kembali
            </a>
            <a href="{{ route('admin.berita.edit', $berita->id) }}" class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                Edit Berita
            </a>
        </div>
    </div>
</div>
@endsection